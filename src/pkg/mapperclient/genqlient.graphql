query ServiceIntentsUpToMapperV017($namespaces: [String!]) {
    serviceIntents(namespaces: $namespaces) {
        client {
            ...NamespacedNameFragment
        }
        intents {
            ...NamespacedNameFragment
        }
    }
}

fragment NamespacedNameFragment on OtterizeServiceIdentity {
    name
    namespace
}

fragment LabelsFragment on OtterizeServiceIdentity {
    labels {
        key
        value
    }
}

fragment NamespacedNameWithLabelsFragment on OtterizeServiceIdentity {
    ...NamespacedNameFragment
    ...LabelsFragment
}


query ServiceIntentsWithLabels($namespaces: [String!], $includedLabels: [String!], $includeAllLabels: Boolean!) {
    serviceIntents(namespaces: $namespaces, includeLabels: $includedLabels, includeAllLabels: $includeAllLabels) {
        client {
            ...NamespacedNameWithLabelsFragment
        }
        intents {
            ...NamespacedNameWithLabelsFragment
        }
    }
}

mutation ResetCapture {
    resetCapture
}

query Intents($namespaces: [String!], $includedLabels: [String!], $includeAllLabels: Boolean!) {
    intents(namespaces: $namespaces, includeLabels: $includedLabels, includeAllLabels: $includeAllLabels) {
        client {
            ...NamespacedNameWithLabelsFragment
        }
        server {
            ...NamespacedNameWithLabelsFragment
        }
        type
        kafkaTopics {
            name
            operations
        }
        httpResources {
            path
            methods
        }
    }
}